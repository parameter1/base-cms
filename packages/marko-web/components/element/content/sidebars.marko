import { getAsObject, getAsArray } from "@parameter1/base-cms-object-path";
import extractRender from "../extract-render";

$ const { parseEmbeddedMedia, res } = out.global;

$ const identifiers = getAsArray(input, 'obj.sequences');

<marko-web-obj-array|{ value, identifier }|
  type="content"
  block-name=input.blockName
  obj=input.obj
  field="sidebars"
  tag=input.tag
  class=input.class
  modifiers=input.modifiers
  attrs=input.attrs
  identifiers=identifiers
>
  $ const v = value == null ? "" : `${value}`.trim();
  $ const embedOptions = getAsObject(input, "embedOptions");
  $ const obj = { sidebar: parseEmbeddedMedia(v, res, embedOptions) };
  $ const textAttrs = { ...(identifier && { id: identifier }) }
  <marko-web-obj-text
    type="content"
    block-name=input.blockName
    obj=obj
    field="sidebar"
    html=true
    attrs=textAttrs
    ...extractRender(input)
  />
</marko-web-obj-array>
